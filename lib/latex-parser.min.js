(function(e){var t=e.define;typeof t!="function"&&(typeof module!="undefined"?t=function(e,t){require("amdefine")(module)(t)}:t=function(e,t){window.LatexParser=t()}),t("latex-parser",function(){return function(){function e(e){return'"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E-\x1F\x80-\uFFFF]/g,escape)+'"'}var t={parse:function(t,n){function a(e,t,n){var r=e,i=n-e.length;for(var s=0;s<i;s++)r=t+r;return r}function f(e){var t=e.charCodeAt(0),n,r;return t<=255?(n="x",r=2):(n="u",r=4),"\\"+n+a(t.toString(16).toUpperCase(),"0",r)}function l(e){var t={};for(var n in e)t[n]=e[n];return t}function c(e,n){var r=e.offset+n;for(var i=e.offset;i<r;i++){var s=t.charAt(i);s==="\n"?(e.seenCR||e.line++,e.column=1,e.seenCR=!1):s==="\r"||s==="\u2028"||s==="\u2029"?(e.line++,e.column=1,e.seenCR=!0):(e.column++,e.seenCR=!1)}e.offset+=n}function h(e){if(i.offset<o.offset)return;i.offset>o.offset&&(o=l(i),u=[]),u.push(e)}function p(){var e,t,n,r,s;return r=l(i),s=l(i),e=j(),e!==null?(t=d(),t!==null?(n=j(),n!==null?e=[e,t,n]:(e=null,i=l(s))):(e=null,i=l(s))):(e=null,i=l(s)),e!==null&&(e=function(e,t,n,r){return r}(r.offset,r.line,r.column,e[1])),e===null&&(i=l(r)),e}function d(){var e,t;return t=l(i),e=v(),e=e!==null?e:"",e!==null&&(e=function(e,t,n,r){return{type:"Document",elements:r!==""?r:[]}}(t.offset,t.line,t.column,e)),e===null&&(i=l(t)),e}function v(){var e,t,n,r,s,o,u;s=l(i),o=l(i),e=m();if(e!==null){t=[],u=l(i),n=j(),n!==null?(r=m(),r!==null?n=[n,r]:(n=null,i=l(u))):(n=null,i=l(u));while(n!==null)t.push(n),u=l(i),n=j(),n!==null?(r=m(),r!==null?n=[n,r]:(n=null,i=l(u))):(n=null,i=l(u));t!==null?e=[e,t]:(e=null,i=l(o))}else e=null,i=l(o);return e!==null&&(e=function(e,t,n,r,i){var s=[r];for(var o=0;o<i.length;o++)s.push(i[o][1]);return s}(s.offset,s.line,s.column,e[0],e[1])),e===null&&(i=l(s)),e}function m(){var e,t;return t=l(i),e=x(),e!==null&&(e=function(e,t,n,r){return{command:r}}(t.offset,t.line,t.column,e)),e===null&&(i=l(t)),e===null&&(t=l(i),e=T(),e!==null&&(e=function(e,t,n,r){return{math:r}}(t.offset,t.line,t.column,e)),e===null&&(i=l(t)),e===null&&(t=l(i),e=y(),e!==null&&(e=function(e,t,n,r){return{text:r}}(t.offset,t.line,t.column,e)),e===null&&(i=l(t)))),e}function g(){var e;return t.length>i.offset?(e=t.charAt(i.offset),c(i,1)):(e=null,s===0&&h("any character")),e}function y(){var e,t,n;n=l(i),t=b();if(t!==null){e=[];while(t!==null)e.push(t),t=b()}else e=null;return e!==null&&(e=function(e,t,n,r){return{content:r.join(""),line:t,column:n}}(n.offset,n.line,n.column,e)),e===null&&(i=l(n)),e}function b(){var e,n,r,o,u;return r=l(i),o=l(i),u=l(i),s++,t.charCodeAt(i.offset)===92?(e="\\",c(i,1)):(e=null,s===0&&h('"\\\\"')),e===null&&(t.charCodeAt(i.offset)===37?(e="%",c(i,1)):(e=null,s===0&&h('"%"')),e===null&&(t.substr(i.offset,2)==="\\]"?(e="\\]",c(i,2)):(e=null,s===0&&h('"\\\\]"')),e===null&&(t.charCodeAt(i.offset)===36?(e="$",c(i,1)):(e=null,s===0&&h('"$"'))))),s--,e===null?e="":(e=null,i=l(u)),e!==null?(n=g(),n!==null?e=[e,n]:(e=null,i=l(o))):(e=null,i=l(o)),e!==null&&(e=function(e,t,n,r){return r}(r.offset,r.line,r.column,e[1])),e===null&&(i=l(r)),e===null&&(t.substr(i.offset,7)==="\\LaTeX\\"?(e="\\LaTeX\\",c(i,7)):(e=null,s===0&&h('"\\\\LaTeX\\\\"')),e===null&&(t.substr(i.offset,2)==="\\\\"?(e="\\\\",c(i,2)):(e=null,s===0&&h('"\\\\\\\\"')),e===null&&(r=l(i),t.charCodeAt(i.offset)===92?(e="\\",c(i,1)):(e=null,s===0&&h('"\\\\"')),e!==null?(n=w(),n!==null?e=[e,n]:(e=null,i=l(r))):(e=null,i=l(r))))),e}function w(){var e;return t.charCodeAt(i.offset)===123?(e="{",c(i,1)):(e=null,s===0&&h('"{"')),e===null&&(t.charCodeAt(i.offset)===125?(e="}",c(i,1)):(e=null,s===0&&h('"}"')),e===null&&(t.charCodeAt(i.offset)===37?(e="%",c(i,1)):(e=null,s===0&&h('"%"')),e===null&&(t.charCodeAt(i.offset)===36?(e="$",c(i,1)):(e=null,s===0&&h('"$"')),e===null&&(t.charCodeAt(i.offset)===64?(e="@",c(i,1)):(e=null,s===0&&h('"@"')))))),e}function E(){var e,n,r,o,u,a,f;u=l(i),t.charCodeAt(i.offset)===37?(e="%",c(i,1)):(e=null,s===0&&h('"%"'));if(e!==null){n=[],a=l(i),f=l(i),s++,r=S(),s--,r===null?r="":(r=null,i=l(f)),r!==null?(o=g(),o!==null?r=[r,o]:(r=null,i=l(a))):(r=null,i=l(a));while(r!==null)n.push(r),a=l(i),f=l(i),s++,r=S(),s--,r===null?r="":(r=null,i=l(f)),r!==null?(o=g(),o!==null?r=[r,o]:(r=null,i=l(a))):(r=null,i=l(a));n!==null?e=[e,n]:(e=null,i=l(u))}else e=null,i=l(u);return e}function S(){var e;return t.charCodeAt(i.offset)===10?(e="\n",c(i,1)):(e=null,s===0&&h('"\\n"')),e}function x(){var e,n,r,o,u,a,f;a=l(i),f=l(i),t.charCodeAt(i.offset)===92?(e="\\",c(i,1)):(e=null,s===0&&h('"\\\\"'));if(e!==null){n=H();if(n!==null){t.charCodeAt(i.offset)===42?(r="*",c(i,1)):(r=null,s===0&&h('"*"')),r=r!==null?r:"";if(r!==null){o=[],u=A();while(u!==null)o.push(u),u=A();o!==null?e=[e,n,r,o]:(e=null,i=l(f))}else e=null,i=l(f)}else e=null,i=l(f)}else e=null,i=l(f);return e!==null&&(e=function(e,t,n,r,i){return{name:r,args:i.join(""),line:t,column:n}}(a.offset,a.line,a.column,e[1],e[3])),e===null&&(i=l(a)),e}function T(){var e,n,r,o,u;return o=l(i),u=l(i),t.substr(i.offset,2)==="\\["?(e="\\[",c(i,2)):(e=null,s===0&&h('"\\\\["')),e!==null?(n=k(),n=n!==null?n:"",n!==null?(t.substr(i.offset,2)==="\\]"?(r="\\]",c(i,2)):(r=null,s===0&&h('"\\\\]"')),r!==null?e=[e,n,r]:(e=null,i=l(u))):(e=null,i=l(u))):(e=null,i=l(u)),e!==null&&(e=function(e,t,n,r){return r}(o.offset,o.line,o.column,e[1])),e===null&&(i=l(o)),e===null&&(o=l(i),u=l(i),t.charCodeAt(i.offset)===36?(e="$",c(i,1)):(e=null,s===0&&h('"$"')),e!==null?(n=N(),n=n!==null?n:"",n!==null?(t.charCodeAt(i.offset)===36?(r="$",c(i,1)):(r=null,s===0&&h('"$"')),r!==null?e=[e,n,r]:(e=null,i=l(u))):(e=null,i=l(u))):(e=null,i=l(u)),e!==null&&(e=function(e,t,n,r){return r}(o.offset,o.line,o.column,e[1])),e===null&&(i=l(o))),e}function N(){var e,t,n;n=l(i),t=L();if(t!==null){e=[];while(t!==null)e.push(t),t=L()}else e=null;return e!==null&&(e=function(e,t,n,r){return r.join("")}(n.offset,n.line,n.column,e)),e===null&&(i=l(n)),e}function C(){var e,n,r,o,u;return r=l(i),o=l(i),u=l(i),s++,t.substr(i.offset,2)==="\\]"?(e="\\]",c(i,2)):(e=null,s===0&&h('"\\\\]"')),s--,e===null?e="":(e=null,i=l(u)),e!==null?(n=g(),n!==null?e=[e,n]:(e=null,i=l(o))):(e=null,i=l(o)),e!==null&&(e=function(e,t,n,r){return r}(r.offset,r.line,r.column,e[1])),e===null&&(i=l(r)),e}function k(){var e,t,n;n=l(i),t=C();if(t!==null){e=[];while(t!==null)e.push(t),t=C()}else e=null;return e!==null&&(e=function(e,t,n,r){return r.join("")}(n.offset,n.line,n.column,e)),e===null&&(i=l(n)),e}function L(){var e,n,r,o,u;return r=l(i),o=l(i),u=l(i),s++,t.charCodeAt(i.offset)===36?(e="$",c(i,1)):(e=null,s===0&&h('"$"')),s--,e===null?e="":(e=null,i=l(u)),e!==null?(n=g(),n!==null?e=[e,n]:(e=null,i=l(o))):(e=null,i=l(o)),e!==null&&(e=function(e,t,n,r){return r}(r.offset,r.line,r.column,e[1])),e===null&&(i=l(r)),e}function A(){var e,n,r,o,u;return o=l(i),u=l(i),t.charCodeAt(i.offset)===91?(e="[",c(i,1)):(e=null,s===0&&h('"["')),e!==null?(n=M(),n=n!==null?n:"",n!==null?(t.charCodeAt(i.offset)===93?(r="]",c(i,1)):(r=null,s===0&&h('"]"')),r!==null?e=[e,n,r]:(e=null,i=l(u))):(e=null,i=l(u))):(e=null,i=l(u)),e!==null&&(e=function(e,t,n,r){return"["+r+"]"}(o.offset,o.line,o.column,e[1])),e===null&&(i=l(o)),e===null&&(o=l(i),u=l(i),t.charCodeAt(i.offset)===123?(e="{",c(i,1)):(e=null,s===0&&h('"{"')),e!==null?(n=D(),n=n!==null?n:"",n!==null?(t.charCodeAt(i.offset)===125?(r="}",c(i,1)):(r=null,s===0&&h('"}"')),r!==null?e=[e,n,r]:(e=null,i=l(u))):(e=null,i=l(u))):(e=null,i=l(u)),e!==null&&(e=function(e,t,n,r){return"{"+r+"}"}(o.offset,o.line,o.column,e[1])),e===null&&(i=l(o))),e}function O(){var e,n,r,o;return o=l(i),t.charCodeAt(i.offset)===123?(e="{",c(i,1)):(e=null,s===0&&h('"{"')),e!==null?(n=D(),n=n!==null?n:"",n!==null?(t.charCodeAt(i.offset)===125?(r="}",c(i,1)):(r=null,s===0&&h('"}"')),r!==null?e=[e,n,r]:(e=null,i=l(o))):(e=null,i=l(o))):(e=null,i=l(o)),e}function M(){var e,t,n;n=l(i),t=_();if(t!==null){e=[];while(t!==null)e.push(t),t=_()}else e=null;return e!==null&&(e=function(e,t,n,r){return r.join("")}(n.offset,n.line,n.column,e)),e===null&&(i=l(n)),e}function _(){var e,n,r,o,u;return r=l(i),o=l(i),u=l(i),s++,t.charCodeAt(i.offset)===93?(e="]",c(i,1)):(e=null,s===0&&h('"]"')),s--,e===null?e="":(e=null,i=l(u)),e!==null?(n=g(),n!==null?e=[e,n]:(e=null,i=l(o))):(e=null,i=l(o)),e!==null&&(e=function(e,t,n,r){return r}(r.offset,r.line,r.column,e[1])),e===null&&(i=l(r)),e}function D(){var e,t,n;n=l(i),t=P();if(t!==null){e=[];while(t!==null)e.push(t),t=P()}else e=null;return e!==null&&(e=function(e,t,n,r){return r.join("")}(n.offset,n.line,n.column,e)),e===null&&(i=l(n)),e}function P(){var e,n,r,o,u;return r=l(i),o=l(i),u=l(i),s++,t.charCodeAt(i.offset)===123?(e="{",c(i,1)):(e=null,s===0&&h('"{"')),e===null&&(t.charCodeAt(i.offset)===125?(e="}",c(i,1)):(e=null,s===0&&h('"}"'))),s--,e===null?e="":(e=null,i=l(u)),e!==null?(n=g(),n!==null?e=[e,n]:(e=null,i=l(o))):(e=null,i=l(o)),e!==null&&(e=function(e,t,n,r){return r}(r.offset,r.line,r.column,e[1])),e===null&&(i=l(r)),e===null&&(e=O()),e}function H(){var e,n,r;r=l(i),/^[a-zA-Z]/.test(t.charAt(i.offset))?(n=t.charAt(i.offset),c(i,1)):(n=null,s===0&&h("[a-zA-Z]"));if(n!==null){e=[];while(n!==null)e.push(n),/^[a-zA-Z]/.test(t.charAt(i.offset))?(n=t.charAt(i.offset),c(i,1)):(n=null,s===0&&h("[a-zA-Z]"))}else e=null;return e!==null&&(e=function(e,t,n,r){return r.join("")}(r.offset,r.line,r.column,e)),e===null&&(i=l(r)),e}function B(){var e,t;e=[],t=F(),t===null&&(t=E());while(t!==null)e.push(t),t=F(),t===null&&(t=E());return e}function j(){var e,t;e=[],t=F(),t===null&&(t=q(),t===null&&(t=E()));while(t!==null)e.push(t),t=F(),t===null&&(t=q(),t===null&&(t=E()));return e}function F(){var e;return s++,/^[\t\x0B\f \xA0\uFEFF]/.test(t.charAt(i.offset))?(e=t.charAt(i.offset),c(i,1)):(e=null,s===0&&h("[\\t\\x0B\\f \\xA0\\uFEFF]")),e===null&&(e=I()),s--,s===0&&e===null&&h("whitespace"),e}function I(){var e;return/^[ \xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000]/.test(t.charAt(i.offset))?(e=t.charAt(i.offset),c(i,1)):(e=null,s===0&&h("[ \\xA0\\u1680\\u180E\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200A\\u202F\\u205F\\u3000]")),e}function q(){var e;return s++,t.charCodeAt(i.offset)===10?(e="\n",c(i,1)):(e=null,s===0&&h('"\\n"')),e===null&&(t.substr(i.offset,2)==="\r\n"?(e="\r\n",c(i,2)):(e=null,s===0&&h('"\\r\\n"')),e===null&&(t.charCodeAt(i.offset)===13?(e="\r",c(i,1)):(e=null,s===0&&h('"\\r"')),e===null&&(t.charCodeAt(i.offset)===8232?(e="\u2028",c(i,1)):(e=null,s===0&&h('"\\u2028"')),e===null&&(t.charCodeAt(i.offset)===8233?(e="\u2029",c(i,1)):(e=null,s===0&&h('"\\u2029"')))))),s--,s===0&&e===null&&h("end of line"),e}function R(e){e.sort();var t=null,n=[];for(var r=0;r<e.length;r++)e[r]!==t&&(n.push(e[r]),t=e[r]);return n}var r={start:p,Document:d,SourceElements:v,SourceElement:m,SourceCharacter:g,TextCharacters:y,TextCharacter:b,EscapedCharacter:w,SingleLineComment:E,LineTerminator:S,Command:x,MathBlock:T,SingleLineMathCharacters:N,MultiLineMathCharacter:C,MultiLineMathCharacters:k,SingleLineMathCharacter:L,CommandArgument:A,CurlyBlock:O,SquareCharacters:M,SquareCharacter:_,CurlyCharacters:D,CurlyCharacter:P,CommandName:H,_:B,__:j,WhiteSpace:F,Zs:I,LineTerminatorSequence:q};if(n!==undefined){if(r[n]===undefined)throw new Error("Invalid rule name: "+e(n)+".")}else n="start";var i={offset:0,line:1,column:1,seenCR:!1},s=0,o={offset:0,line:1,column:1,seenCR:!1},u=[],U=r[n]();if(U===null||i.offset!==t.length){var z=Math.max(i.offset,o.offset),W=z<t.length?t.charAt(z):null,X=i.offset>o.offset?i:o;throw new this.SyntaxError(R(u),W,z,X.line,X.column)}return U},toSource:function(){return this._source}};return t.SyntaxError=function(t,n,r,i,s){function o(t,n){var r,i;switch(t.length){case 0:r="end of input";break;case 1:r=t[0];break;default:r=t.slice(0,t.length-1).join(", ")+" or "+t[t.length-1]}return i=n?e(n):"end of input","Expected "+r+" but "+i+" found."}this.name="SyntaxError",this.expected=t,this.found=n,this.message=o(t,n),this.offset=r,this.line=i,this.column=s},t.SyntaxError.prototype=Error.prototype,t}()})})(this);